<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8'>
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="description" content="Project inference : Design an experiment which requires human subjects to do inference, analyse, mine and model their behavior to understand whether/how they do inference ?">
  <link rel="stylesheet" type="text/css" media="screen" href="../stylesheets/stylesheet.css">
  <link rel="stylesheet" href="../fonts/Serif/cmun-serif.css" />

  <!--Mathematics with MathJax-->
  <script type="text/x-mathjax-config">      
    MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: true
  },
  "HTML-CSS": { 
  availableFonts: ["STIX"],
}
});
</script>
<script type="text/javascript" async
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
</script>  

</head>

<body>

  <title>Model comparison location task</title>

  <!-- HEADER -->
  <div id="header_wrap" class="outer">
    <header class="inner">
      <a id="forkme_banner" href="https://github.com/steevelaquitaine/projInference">Github</a>
      <a id="project_author" href="http://steevelaquitaine.blogspot.com">Steeve laquitaine </a>
    </header>
  </div>

  <!--TITLE-->
  <div id="proj_title_wrap" class="outer">
    <header class="inner">
      <section id="proj_title" class="inner">
        <h1 id="proj_title"> Model comparison location task </h1>
      </div>

      <!--Table of contents    -->
      <div id="Table_of_content_wrap" class="outer">
        <section id="table_of_content" class="inner">
          <h5 id="top"> TABLE OF CONTENTS </h5>       
          <h7><a href="#briefly"> <b>Briefly </b><br></h7>
          <h7><a href="#BBO"> <b>Bayes MAP </b><br></h7>
          <h7><a href="#sw"> <b>Switching </b><br></h7>
          <h7><a href="#SPP"> <b>Switching between posterior and prior</b><br></h7>
          <h7><a href="#BBC"> <b>Basic Bayesian obs. card </b><br></h7>
          <h7><a href="#BS"> <b>Bayes sampling </b><br></h7>
          <h7><a href="#BSC"> <b>Bayes sampling with cardinal </b><br></h7>          
          <h7><a href="#BTP"><b>Bayes with long tailed prior </b><br></h7>
          <h7><a href="#mcsc"><b>Model comparison (only strongest contrasts) </b><br></h7>
          <h7><a href="#BBOsc"> &nbsp <b>Basic Bayesian observer </b><br></h7>
          <h7><a href="#swsc"> &nbsp <b>Switching </b><br></h7>
          <h7><a href="#SPPsc"> &nbsp <b>Switching between posterior and prior</b><br></h7>
          <h7><a href="#BBCsc"> &nbsp <b>Basic Bayesian obs. card </b><br></h7>
          <h7><a href="#BSsc"> &nbsp <b>Bayes sampling </b><br></h7>
          <h7><a href="#BSCsc"> &nbsp <b>Bayes sampling with cardinal </b><br></h7>        
          <h7><a href="#BTPsc">&nbsp <b>Bayes with long tailed prior </b><br></h7>
          <h7><a href="#AIC">&nbsp <b>AIC </b><br></h7>
        </section>
      </div>    

      <!-- MAIN CONTENT -->
      <div id="main_content_wrap" class="outer">
        <section id="main_content" class="inner">                

          <p><h7><a id="briefly" class="anchor" href="#briefly" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Briefly</b></a></h7> </p>

          <p> We fitted all the relevant models tested previously with for the motion direction estimation task in the location task except the Bayesian observer with long tailed likelihood models. This model is only relevant for random dot motion as it describes this stimulus statistics but not the location stimulus statistics. Like for the direction task, we first searched for reasonable initial parameters that reproduced estimate distributions best alternating manual tuning of initial paramaters with quick fminsearch fits of the data. Graphical fitting indicated that predicted distributions were very sensitive to the magnitude of the initial parameters such as changing priors by 0.1 can sometimes evidently changed estimate distribution shapes and log likelihood of the data given the model </p></p>


          <p><h7><a id="BBO" class="anchor" href="#BBO" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Basic Bayesian observer</b></a></h7> </p>

          <p>We searched for best initial parameters graphically :</p>
          <!--Code-->
          <code class="code">
            datapath = '~/data/dataPsychophy/proj04_LocPriorStrengthFinal';<br>        
            SLfitBayesianModel({'sub06'},[600 2 1 0.7 1 2 20 NaN 0.001 15 NaN],
            'dataPathVM',datapath,'experiment','vonMisesPrior','MAPReadout',
            'modelPredictions','withData','inputFitParameters');
          </code>

          <p> We then fitted the model to each subject data (first load initp from ../data/TableInitpBasicBILocation.csv)</p>      
          <!--Code-->
          <code class="code">
            datapath = '~/data/dataPsychophy/proj04_LocPriorStrengthFinal';<br>
            subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};<br>
            initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 NaN 0.001 40 NaN;
            200 1.1 0.6 0.3 1.5 2 2.5 NaN 0.001 60 NaN;
            200 1.5 1 0.4 2 2 2 NaN 0.001 60 NaN;
            600 1 0.5 0.4 1 1 20 NaN 0.001 15 NaN;
            600 0.8 0.8 0.2 0.2 0.4 0.4 NaN 0.001 15 NaN;
            600 2 1 0.7 1 2 20 NaN 0.001 15 NaN]<br><br>
            for i = 1 : length(subs)<br>
            SLfitBayesianModel(subs(i),initp(i,:),
            'dataPathVM',datapath,'experiment','vonMisesPrior',
            'filename','datafit','MAPReadout','MaxLikelihoodFit','fminsearch','filename',['data' subs{i}]);<br>
            end
          </code>



          <!--section-->
          <p><h7><a id="sw" class="anchor" href="#sw" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Switching between likelihood and prior</b></a></h7> </p>

          <p> Search initp graphically : </p>

          <code class="code">    
            clear;
            subject = {'sub02'};
            datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data'
            initp = [47830 0.8 0.8 0.11 8.4 8.4 8.4 NaN 0.003 42]
            output = SLfitCompetitionModel(subject,initp,...
            'inputFitParameters',...
            'dataPathVM',datapath,'experiment','vonMisesPrior', 'modelPredictions','withData',...
            'filename','pred');
          </code >    

          <p>Then fit : </p>

          <code class="code">          
            clear <br>          
            tic<br>
            subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};<br>
            datapath = '/Volumes/MoonData/data/dataPsychophy/proj04_LocPriorStrengthFinal/data'<br><br>

            initp = [20 6 2 0.1 1 2 5 NaN 0.02 40;
            47830 0.8 0.8 0.11 8.4 8.4 8.4 NaN 0.003 42;
            5000 3 1.3 0.5 0.7 5 6 NaN 0.01 32;
            49767 2 1.3 0.3 3 5.6 40.9 NaN 0.001 32.15;
            200 0.8 0.6 0.08 0.1 0.2 0.2 NaN 0.005 60;
            500 30 2 0.6 2 5 7 NaN 0.02 40];<br><br>

            pscales = ones(6,10)<br><br>

            for i = 1 : length(subject)<br>
            output = SLfitCompetitionModel(subject(i),initp(i,:),
            'pscaling',pscales(i,:),
            'dataPathVM',datapath,'experiment','vonMisesPrior',
            'MaxLikelihoodFit','fminsearch','filename','datafit');<br>                 
            end
          </code>  


          <p><b>Results:</b> The Bayesian observer won against Switching only for Subject 2 and 4. </p>


          <!--section-->
          <p><h7><a id="SPP" class="anchor" href="#BLTL" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Switching between posterior and prior</b></a></h7> </p>  
          <p></p>

          <p>We searched for initial parameters by matching predictions and estimate distribution best : </p>

          <code class= "code">
            datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal'; <br>
            output = SLfitCompetitionModel({'sub01'},
            [80 30 2 0.7 5 7 33 NaN 0.001 30],
            'dataPathVM',datapath,'experiment','vonMisesPrior',
            'modelPredictions','withData',
            'inputFitParameters',
            'filename','fitswitchPostorPrior',
            'switchPostorPrior');            
          </code>

          <p> Observations were same as when fitting the direction data. Initial parameters were the same as the switching initial parameters for the location task.</p>

          <code class= "code">          
            initp = [20 6 2 0.1 1 2 5 NaN 0.02 40;
            47830 0.8 0.8 0.11 8.4 8.4 8.4 NaN 0.003 42;
            5000 3 1.3 0.5 0.7 5 6 NaN 0.01 32;
            49767 2 1.3 0.3 3 5.6 40.9 NaN 0.001 32.15;
            200 0.8 0.6 0.08 0.1 0.2 0.2 NaN 0.005 60;
            500 30 2 0.6 2 5 7 NaN 0.02 40];
          </code>

          <p>We then fitted the model to the data</p>

          <code class="code">        
            clear <br>          
            tic <br>
            subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};<br>
            datapath = '/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data'<br>
            pscales = ones(6,10) <br><br>

            for i = 1 : length(subject)<br>
            output = SLfitCompetitionModel(subject(i),initp(i,:),
            'pscaling',pscales(i,:),
            'dataPathVM',datapath,'experiment','vonMisesPrior',
            'MaxLikelihoodFit','fminsearch',
            'filename','datafitswPoOrPr',
            'switchPostorPrior');<br>                 
            end
            toc
          </code>

          <!--SECTION-->
          <p><h7><a id="BBC" class="anchor" href="#BBC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Basic Bayesian obs, card</b></a></h7> </p>     

          <p> Initial parameters were set as the same as initial parameters for Basic Bayesian observer with cardinal prior strength initialize at zero and model was fit to the data </p>

          <code class="code">
            datapath = '~/Desktop/proj04_LocPriorStrengthFinal';<br><br>
            subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};<br><br>
            initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 0 0.001 40 NaN;
            200 1.1 0.6 0.3 1.5 2 2.5 0 0.001 60 NaN;
            200 1.5 1 0.4 2 2 2 0 0.001 60 NaN;
            600 1 0.5 0.4 1 1 20 0 0.001 15 NaN;
            600 0.8 0.8 0.2 0.2 0.4 0.4 0 0.001 15 NaN;
            600 2 1 0.7 1 2 20 0 0.001 15 NaN];<br><br>

            pscales = ones(6,11)<br><br>

            for i = 1 : length(subs)<br>
            SLfitBayesianModel(subs(i),initp(i,:),
            'dataPathVM',datapath,'experiment','vonMisesPrior',
            'filename','datafit','MAPReadout','MaxLikelihoodFit',
            'fminsearch','filename',['data' subs{i}]);<br>
            end 
          </code>


          <!--section-->
          <p><h7><a id="BS" class="anchor" href="#BS" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes sampling</b></a></h7> </p>              

          <p> Setup fit :
            <code class="code">          
              subject = {'sub01'};
              datapath = '~/Dropbox/dataPsychophy/proj04_LocPriorStrengthFinal/data/';
              initp = [200 1.8 1.8 0.5 0.5 0.8 1.5 NaN 0.001 40 NaN];
              pscales = [1e-2 1 1 10 10 10 1 NaN 1e3 1e-2 NaN];
            </code>          
          </p>


          <p>Find initial fit parameters (stored in ../data/TableInitpBaySmpLocation.csv)        
            <code class="code">          
              output = slshortPlotPredBayesSmp(subject,initp,pscales,datapath)
            </code>
          </p>


          <p>Fit :
            <code class="code">                
              tic<br>
              subject = {'sub01','sub02','sub03','sub04','sub05','sub06'}; <br>
              datapath = '~/Desktop/proj04_LocPriorStrengthFinal/data/';<br><br>

              initp = [200 3 1.8 0.5 0.5 0.8 3 NaN 0.001 40 NaN;
              200 1.8 1.8 0.5 4 4 10 NaN 0.001 40 NaN;
              200 1.8 1.8 0.5 4 4 10 NaN 0.001 40 NaN;
              200 1.8 1.8 0.5 2 4 20 NaN 0.001 40 NaN;
              200 1.5 1 0.1 0.5 1 1 NaN 0.001 40 NaN;
              200 3 1.8 0.5 4,6 10 NaN 0.001 40 NaN]<br><br>

              pscales = ones(1,11);<br><br>

              for i = 1 : length(subject)<br>
              output = slshortfitBayesSmp(subject(i),initp(i,:),pscales(i,:),datapath);<br>
              outputall{i} = output;<br>
              end<br>
              toc<br><br>
            </code>
          </p>

          <br>
          <br>


          <!--section-->
          <p><h7><a id="BSC" class="anchor" href="#BSC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes sampling with cardinal</b></a></h7> </p>  

          <b>Bayes Sampling with cardinal</b> :  use same initial parameters (parameters in ../data/TableInitpBaySmpCardLocation.csv) as Bayes sampling and set cardinal prior initial parameter k=0 for fit. note : scaling to same order of magnitude does not help (don't know why). </p>

          <code class="code">                

            tic<br>
            subject = {'sub01','sub02','sub03','sub04','sub05','sub06'}; <br>
            datapath = '~/Desktop/proj04_LocPriorStrengthFinal/data/';<br><br>

            initp = [200 3 1.8 0.5 0.5 0.8 3 0 0.001 40 NaN;
            200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
            200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
            200 1.8 1.8 0.5 2 4 20 0 0.001 40 NaN;
            200 1.5 1 0.1 0.5 1 1 0 0.001 40 NaN;
            200 3 1.8 0.5 4,6 10 0 0.001 40 NaN];<br><br>

            pscales = ones(6,11);<br><br>

            for i = 1 : length(subject)<br>
            output = slshortfitBayesSmp(subject(i),initp(i,:),pscales(i,:),datapath);<br>
            outputall{i} = output;<br>
            end<br>
            toc<br><br>

          </code>


          

          <!--section-->
          <p><h7><a id="BTP" class="anchor" href="#BTP" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes with long tailed prior</b></a></h7> </p>  

          <code class="code">      

            clear <br>
            tic<br>

            subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};<br>
            datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data/';<br><br>

            initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 NaN 0.001 40 0;<br>
            200 1.1 0.6 0.3 1.5 2 2.5 NaN 0.001 60 0;<br>
            200 1.5 1 0.4 2 2 2 NaN 0.001 60 0;<br>
            600 1 0.5 0.4 1 1 20 NaN 0.001 15 0;<br>
            600 0.8 0.8 0.2 0.2 0.4 0.4 NaN 0.001 15 0;<br>
            600 2 1 0.7 1 2 20 NaN 0.001 15 0];<br><br>

            pscales = ones(6,11); <br>

            for i = 1 : length(subject)<br>
            output = slshortfitBayesTailedPrior(subject(i),initp(i,:),pscales(i,:),datapath);<br>
            outputall{i} = output;<br>
            end<br>
            toc<br>

          </code>

          <p><h7><a id="BTP" class="anchor" href="#BTP" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes sampling card</b></a></h7> </p>  

          <code class="code">                  
            tic
            subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};
            datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data/';

            initp = [200 3 1.8 0.5 0.5 0.8 3 0 0.001 40 NaN;
            200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
            200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
            200 1.8 1.8 0.5 2 4 20 0 0.001 40 NaN;
            200 1.5 1 0.1 0.5 1 1 0 0.001 40 NaN;
            200 3 1.8 0.5 4,6 10 0 0.001 40 NaN];

            pscales = ones(6,11);

            for i = 1 : length(subject)
            output = SLfitBayesianModel(subject(i),initp(i,:),'pscaling',pscales(i,:),...
            'dataPathVM',datapath,'experiment',...
            'vonMisesPrior','filename','fitbsamp',...
            'SamplingReadout','MaxLikelihoodFit','fminsearch',...
            'removeStimStrength',0.1, 'debug');
            end
            toc
          </code>      

          <!--section-->
          <p><h7><a id="AIC" class="anchor" href="#AIC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>AIC table</b></a></h7> </p>  

          <code class="code">      
           path = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/modelfit/AIC/'; <br>
           model_ref = 'model_CompDiv'; <br>
           models = {'model_Bayes_MAP',
           'model_Bayes_Sampling',
           'model_Bayes_Sampling_withCard',
           'model_Bayes_MAP_FatTailPrior',
           'model_Bayes_MAP_withCard'}; 
           [AICsvsSw,semAICsvsSw,aicDiff] = slPlotModelsAICvsSwitchingAIC(model_ref,models,path); <br>
           [e,ci,m,s] = slMakeCI(aicDiff,0.95); <br>
         </code>

         <p>AIC difference (Bayesian models - Switching) between Switching and Bayesian models (column: model_Bayes_MAP, model_Bayes_Sampling, model_Bayes_Sampling_withCard, model_Bayes_MAP_FatTailPrior, model_Bayes_MAP_withCard respectively) when fitting all location data for each subject separately (rows) are </p>

         <code class="code">      
           79   -20   94   48   52 <br>
           -206 -400 -401 -216 -212 <br>
           27   -238 -238   23  158 <br>
           -263 -516 -403 -297 -288 <br>
           102   132  145  101  106 <br>
           504  -28  -26  691  508 <br>
         </code>


         <!--section-->
         <p><h7><a id="wsf" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Why switching sometimes fail?</b></a></h7> </p>  

         <p>Switching fail against Bayesian models when subjects data, although they show a bit of switching are very noisy and there are not enough sessions collected </p>
         <ul>
           <li> sub02 and 04: rare weak switching and much more often very noisy distributions (also fewer data samples : 3 sessions). Here Show sub06 selected distributions from 10 adn 15.6% contrast at prior 40º or/and 20º. Peak visible but data are very noisy. </li> 
           <li> sub01,03,05,06 switched more often and distributions were less noisy (except for subject 1 with 3 sessions other subjects had more data samples : 5, 6, 6 sessions respectively). Here Show sub06 selected distributions from 10 and 15.6% contrast at prior 40º or/and 20º. Two peak very clear, data not noisy. </li>
           <li></li>
         </ul>


         <!--section-->
         <p><h7><a id="mcsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Model comparison (only strongest contrasts)</b></a></h7> </p>  

         <p><b>Results from model comparison with all 3 contrasts conditions</b> : Bayes sampling outperformed the Switching observer or all subjects except the 5th. I believe this is because subjects distributions are very noisy and show weak bimodality. Only subjects 5 and 6 have 6 sessions while other subjects have 3 sessions except subject 3 with 5 sessions. It seems all data at 10% contrast and particularly the 80 deg prior conditions are particularly poorly fit by the models because distribution often look like random noise.</p>

         <p>I run model comparison for each subject separately, but exluding the 10% contrast noisiest condition.</p>


         <!--section-->
         <p><h7><a id="swsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Switching </b></a></h7> </p>  

         <code class="code">    
          datapath = '~/MoonData/data/dataPsychophy/proj04_LocPriorStrengthFinal'; 
          subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};

          initp = [20 6 2 0.1 1 2 5 NaN 0.02 40;
          47830 0.8 0.8 0.11 8.4 8.4 8.4 NaN 0.003 42;
          5000 3 1.3 0.5 0.7 5 6 NaN 0.01 32;
          49767 2 1.3 0.3 3 5.6 40.9 NaN 0.001 32.15;
          200 0.8 0.6 0.08 0.1 0.2 0.2 NaN 0.005 60;
          500 30 2 0.6 2 5 7 NaN 0.02 40];<br><br>

          pscales = ones(6,10)

          for i = 1 : length(subs)  
          output = SLfitCompetitionModel(subs(i),...
          initp(i,:), ...
          'pscaling',pscales(i,:),...
          'dataPathVM',datapath, ...
          'experiment','vonMisesPrior','MaxLikelihoodFit','fminsearch',...
          'filename',['datafit' subs{i}]);
          end
        </code>    

        <p></p>

        <!--section-->
        <p><h7><a id="BSsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes sampling </b></a></h7> </p>  

        <code class="code">
          tic
          addpath(genpath('~/Desktop/SLcodes'))
          addpath(genpath('~/proj/mgl'))
          addpath(genpath('~/proj/mrTools'))
          subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data/';

          initp = [200 3 1.8 0.5 0.5 0.8 3 NaN 0.001 40 NaN;
          200 1.8 1.8 0.5 4 4 10 NaN 0.001 40 NaN;
          200 1.8 1.8 0.5 4 4 10 NaN 0.001 40 NaN;
          200 1.8 1.8 0.5 2 4 20 NaN 0.001 40 NaN;
          200 1.5 1 0.1 0.5 1 1 NaN 0.001 40 NaN;
          200 3 1.8 0.5 4,6 10 NaN 0.001 40 NaN];

          pscales = ones(1,11);

          for i = 1 : length(subject)
          output = SLfitBayesianModel(subject(i),initp(i,:),'pscaling',pscales(i,:),...
          'dataPathVM',datapath,'experiment',...
          'vonMisesPrior','filename','fitbsamp',...
          'SamplingReadout','MaxLikelihoodFit','fminsearch',...
          'removeStimStrength',0.1);
          end
          toc
        </code>

        <!--section-->
        <p><h7><a id="BSCsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes sampling card </b></a></h7> </p>  

        <code class="code">
          tic
          addpath(genpath('~/Desktop/SLcodes'))
          addpath(genpath('~/proj/mgl'))
          addpath(genpath('~/proj/mrTools'))
          tic
          subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data/';

          initp = [200 3 1.8 0.5 0.5 0.8 3 0 0.001 40 NaN;
          200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
          200 1.8 1.8 0.5 4 4 10 0 0.001 40 NaN;
          200 1.8 1.8 0.5 2 4 20 0 0.001 40 NaN;
          200 1.5 1 0.1 0.5 1 1 0 0.001 40 NaN;
          200 3 1.8 0.5 4,6 10 0 0.001 40 NaN];

          pscales = ones(6,11);

          for i = 1 : length(subject)
          output = SLfitBayesianModel(subject(i),initp(i,:),'pscaling',pscales(i,:),...
          'dataPathVM',datapath,'experiment',...
          'vonMisesPrior','filename','fitbsamp',...
          'SamplingReadout','MaxLikelihoodFit','fminsearch',...
          'removeStimStrength',0.1);
          end
          toc
        </code>


        <!--section-->
        <p><h7><a id="BTPsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Bayes long tailed prior </b></a></h7> </p>  

        <code class="code">
          clear 
          tic

          subject = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/data/';

          initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 NaN 0.001 40 0;
          200 1.1 0.6 0.3 1.5 2 2.5 NaN 0.001 60 0;
          200 1.5 1 0.4 2 2 2 NaN 0.001 60 0;
          600 1 0.5 0.4 1 1 20 NaN 0.001 15 0;
          600 0.8 0.8 0.2 0.2 0.4 0.4 NaN 0.001 15 0;
          600 2 1 0.7 1 2 20 NaN 0.001 15 0];

          pscales = ones(6,11); 

          for i = 1 : length(subject)

          output = SLfitBayesianModel(subject(i),initp(i,:),'pscaling',pscales(i,:),...
          'dataPathVM',datapath,'experiment','vonMisesPrior',...
          'FatTailPrior','MAPReadout',...
          'MaxLikelihoodFit','fminsearch',...
          'filename','fitBtailedPrior',...
          'removeStimStrength',0.1)
          end
          toc
        </code>


        <!--section-->
        <p><h7><a id="BBOsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Basic Bayes obs. </b></a></h7> </p>  


        <!--Code-->
        <code class="code">
          datapath = '~/data/dataPsychophy/proj04_LocPriorStrengthFinal';
          subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 NaN 0.001 40 NaN;
          200 1.1 0.6 0.3 1.5 2 2.5 NaN 0.001 60 NaN;
          200 1.5 1 0.4 2 2 2 NaN 0.001 60 NaN;
          600 1 0.5 0.4 1 1 20 NaN 0.001 15 NaN;
          600 0.8 0.8 0.2 0.2 0.4 0.4 NaN 0.001 15 NaN;
          600 2 1 0.7 1 2 20 NaN 0.001 15 NaN];

          pscales = ones(6,11); 

          for i = 1 : length(subs)
          SLfitBayesianModel(subs(i),initp(i,:),...
          'dataPathVM',datapath,'experiment','vonMisesPrior',...
          'filename','datafit','MAPReadout',...
          'MaxLikelihoodFit','fminsearch','filename',['data' subs{i}],...
          'removeStimStrength',0.1);
          end
        </code>


        <!--section-->
        <p><h7><a id="BBCsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Basic Bayes obs card. </b></a></h7> </p>  


        <!--Code-->
        <code class="code">
          %Basic Bayesian obs. card
          datapath = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal';
          subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          initp = [200 1.8 0.5 0.2 0.5 0.8 1.5 0 0.001 40 NaN;
          200 1.1 0.6 0.3 1.5 2 2.5 0 0.001 60 NaN;
          200 1.5 1 0.4 2 2 2 0 0.001 60 NaN;
          600 1 0.5 0.4 1 1 20 0 0.001 15 NaN;
          600 0.8 0.8 0.2 0.2 0.4 0.4 0 0.001 15 NaN;
          600 2 1 0.7 1 2 20 0 0.001 15 NaN];

          pscales = ones(6,11); 

          for i = 1 : length(subs)
          SLfitBayesianModel(subs(i),initp(i,:),'pscaling',pscales(i,:),'dataPathVM',datapath,'experiment','vonMisesPrior','filename','datafit','MAPReadout','MaxLikelihoodFit','fminsearch','filename',['data' subs{i}],'removeStimStrength',0.1);
          end
        </code>

        <!--section-->
        <p><h7><a id="SPPsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Switching between posterior and prior. </b></a></h7> </p>  


        <code class="code">
          %switching between post and prior
          clear           
          tic 
          subs = {'sub01','sub02','sub03','sub04','sub05','sub06'};
          datapath = '~/Desktop/proj04_LocPriorStrengthFinal/data'
          initp = [20 6 2 0.1 1 2 5 NaN 0.02 40;
          47830 0.8 0.8 0.11 8.4 8.4 8.4 NaN 0.003 42;
          5000 3 1.3 0.5 0.7 5 6 NaN 0.01 32;
          49767 2 1.3 0.3 3 5.6 40.9 NaN 0.001 32.15;
          200 0.8 0.6 0.08 0.1 0.2 0.2 NaN 0.005 60;
          500 30 2 0.6 2 5 7 NaN 0.02 40];

          pscales = ones(6,10) 

          for i = 1 : length(subs)
          output = SLfitCompetitionModel(subs(i),initp(i,:),...
          'pscaling',pscales(i,:),...
          'dataPathVM',datapath,'experiment','vonMisesPrior',...
          'MaxLikelihoodFit','fminsearch',...
          'filename',['data' subs{i}],...
          'switchPostorPrior',...
          'removeStimStrength',0.1);                 
          end
          toc
        </code>


        <!--section-->
        <p><h7><a id="SPPsc" class="anchor" href="#wsf" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="#top"><b>Switching between posterior and prior. </b></a></h7> </p>  

        <code class="code">
          path = '~/Desktop/dataPsychophy/proj04_LocPriorStrengthFinal/modelfit/AIC_strgCon/'; <br>
          model_ref = 'model_CompDiv'; <br>
          models = {'model_Bayes_MAP','model_Bayes_Sampling','model_CompDivPostorPrior'}; 
          [AICsvsSw,semAICsvsSw,aicDiff] = slPlotModelsAICvsSwitchingAIC(model_ref,models,path); <br>
          [e,ci,m,s] = slMakeCI(aicDiff,0.95); <br>


        </code>

        </code>

      </section>
    </div>



    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Projinference maintained by <a href="https://github.com/steevelaquitaine">steevelaquitaine</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

  </body>
  </html>
