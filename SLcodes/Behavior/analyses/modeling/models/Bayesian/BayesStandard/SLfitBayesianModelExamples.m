
%SLfitBayesianModelExamples.m
%
%
%  Examples:
%
%-----------------------------------------------------------
%Fit trial-data with maximum likelihood ('MaxLikelihoodFit')
%-----------------------------------------------------------
%
%von Mises priors ('vonMisesPrior')
%
% matlabpool 2
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub02'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15 NaN],...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesWithCard_maxLL_example',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%von Mises priors with Fat Tail ('vonMisesPrior','FatTailPrior')
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [101 70 22 1 3 9.74 34 NaN 0.0007 6.9 0],...
%     'experiment','vonMisesPrior',...
%     'FatTailPrior',...
%     'filename','fit02',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%
%combined priors ('vonMisesprior' and 'bimodalPrior')
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','fit01',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%-----------------------------------------------------------
%Fit basic Bayesian model with no prior 
% trial-data with maximum likelihood ('MaxLikelihoodFit')
%-----------------------------------------------------------
%Description: fit basic Bayesian model assuming no prior : with prior 
%             strengths k fixed at 0.
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15 NaN],...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesWithCard_maxLL_example',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%
%
%
%-----------------------------------------------------------
%fit data mean and std with least-square error for R-squared
%Cross-Validation (mean data and std, 'CrossValR2Fit')
%-----------------------------------------------------------
% matlabpool 7
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub02'},...
%     [10 2.5 1.5 2 5 10 34 NaN 0.001 75],...
%     'experiment','vonMisesPrior',...
%     'filename','fit02',...
%     'SamplingReadout',...
%     'CrossValR2Fit');
%
%
%
%-----------------------------------------------------------
%fit trial data with least-square error for R-squared
%Cross-Validation (trial data, 'CrossValR2FitTrialData')
%-----------------------------------------------------------
%sub01
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [100 20 4 1.5 5 10 34 NaN 0.001 75],...
%     'experiment','vonMisesPrior',...
%     'filename','fit01',...
%     'SamplingReadout',...
%     'CrossValR2FitTrialData');
%
%sub02
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub02'},...
%     [10 2.5 1.5 2 5 10 34 NaN 0.001 75],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_BayesSamplingNoCard_CrossValR2trials_debugging',...
%     'SamplingReadout',...
%     'CrossValR2FitTrialData');
%
%--------------------------------------------------------------------
% ('modelPredictions') - Draw data mean, std and distribution with their
% model predictions for individual subjects or averaged over subjects
%--------------------------------------------------------------------
%The function retrieves the best fit parameters available for each subject
%in :
%
%folder 'modelfit/AIC' to make the predictions.
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','vonMisesPrior',...
%     'MAPReadout',...
%     'modelPredictions','withData',...
%     'directoryFitParameter','../modelfit/AIC/');
%
%folder 'modelfit/bimodalPrior/AIC'
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01','sub02'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','vonMisesPrior',...
%     'MAPReadout',...
%     'modelPredictions',...
%     'withData',...
%     'directoryFitParameter','../modelfit/AIC/',...
%     'filename','dataModelPred_vonMisesPrior_BayesMAPNoCard_MaxLL');
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01','sub02',...
%     'sub03'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','bimodalPrior',...
%     'MAPReadout',...
%     'modelPredictions',...
%     'withData',...
%     'directoryFitParameter','../modelfit/bimodalPrior/AIC/',...
%     'filename','dataModelPred_bimodalPrior_BayesMAPNoCard_MaxLL');
%
%The function retrieves the best fit parameters available for each subject
%in the folder 'modelfit/combinedPrior/AIC' to make the predictions.
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01','sub02',...
%     'sub03'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','bimodalPrior',...
%     'MAPReadout',...
%     'modelPredictions',...
%     'withData',...
%     'directoryFitParameter','../modelfit/combinedPrior/AIC/',...
%     'filename','dataModelPred_bimodalPrior_BayesMAPNoCard_MaxLL');
%
%-------------------------------------------------------------------------
%(Free predictions) Draw model's predicted data mean, std and distribution
%for input parameters
%------------------------------------------------------------------------
% pathLab ='/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/'
% pathHome ='/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% Unimodal
% ........
% ('MAPReadout')
% ................................................
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub10'},...
%     [200 1 1 0.18 1 21.63 300.63 NaN 0.00104 5 NaN],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'MAPReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
% ('SamplingReadout')
% ................................................
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub10'},...
%     [200 3 1.6 0.01 1 21.63 300.63 NaN 0.00104 5 NaN],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'SamplingReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
% ('MAPReadout','FatTailPrior')
% ................................................
%
% close all
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub12'},...
%     [4.5 1.6 1.1 0.02 0.8 1.7 7.2  NaN 0.00039 17 0.12],...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'FatTailPrior',...
%     'MAPReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
% Bimodal
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [0 0 0 100 100 100 100 NaN 0.001 15 0],...
%     'dataPathBim',pathHome,...
%     'experiment','bimodalPrior',...
%     'FatTailPrior',...
%     'MAPReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
% ('SamplingReadout','FatTailPrior')
% ................................................
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub10'},...
%     [200 1 1 0.18 1 21.63 300.63 NaN 0.00104 5 NaN],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'FatTailPrior',...
%     'SamplingReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
%
% ('SamplingReadout','FatTailPrior','ChangeWTail')
% ................................................
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub03'},...
%     [7213.59 178.55 2.97 1 0.31 0.02 0.01  0 0.00128 14.75 923.4248591284],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'FatTailPrior','ChangeWTail',...
%     'SamplingReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
%
% ('SamplingReadout','FatTailPriorAndLLH')
% ................................................
% pathLab = '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub02'},...
%     [10 2 10^1 10^300 65 65 10^300 NaN 0 10^12 0.5],...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'FatTailPriorAndLLH',...
%     'SamplingReadout',...
%     'modelPredictions','withData','inputFitParameters');
%
%
% ('SamplingReadout','FatTailPriorAndLLH','FitEachKvmAndTails')
% .............................................................
%
% pathLab = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2';
%
% pathLab = '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2';
% [~,~,~,~,~,~,~,~,output] = SLfitBayesianModel({'sub02'},...
%     [20 3 2 8 8 14 50 NaN 0 10^200 0 0.1 0.25 0.25 0.05 0.001 0.001],...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'FatTailPriorAndLLH','FitEachKvmAndTails',...
%     'SamplingReadout',...
%     'modelPredictions','withData','inputFitParameters','filename','test',...
%    'LoadDataBase')
%
%
% --------------------------------------------------------------------
%(Free predictions) Draw model's predicted mean, std and distribution
%with simulated experimental priors
%--------------------------------------------------------------------
%
%superimpose prior conditions
%----------------------------
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,...
%     fitPt,negLogl,negLoglbkp,...
%     Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [26 5 1.85 0.7 2.7 8.7 33 NaN 0 3000],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'MAPReadout',...
%     'modelPredictions',...
%     'SuperImposedPrior');
%
%--------------------------------------------------------------------
%Get standard error of best fit parameters ('stdBestfitP')
%--------------------------------------------------------------------
%Fit data with fminsearch first (with 'MaxLikelihoodFit' usage), then
%run this
%
% matlabpool 2
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negLogl,negLoglbkp,Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 0 0.001 15],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesNoCard_stdBestfitP',...
%     'MAPReadout',...
%     'stdBestfitP');
%
%
%----------------------------------------------------
%MAX LIKELIHOOD FIT ('MaxLikelihoodFit','MAPReadout')
%----------------------------------------------------
%used to fit the models
%
%-------------------------------------------------------------------------
%BAYES FAT-TAIL PRIOR, MAP ('MaxLikelihoodFit','vonMisesPrior','MAPReadout')
%-------------------------------------------------------------------------
%initial parameters were evaluated by fitting manually
%- No cardinal priors (set cardinal prior strength to NaN) and
%set the filename
%
%- With cardinal priors (set cardinal prior strength to 0) and
%set the filename
%
% paths
% pathLab =  '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
%subject 01
%----------
% matlabpool 2
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 0 0.001 15 NaN],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesWithCard',...
%     'MAPReadout');
%
% sub02: [101  70 22 1 3 9.74 34 NaN 0.0007 6.9 NaN]
% sub03: [80   40 16 1.7 4.8 11 33 NaN 0.00039 17 NaN]
% sub04: [79.3 38.9 9.19 1.7 4.8 11 33 NaN 0.00039 17 NaN]
% sub05: [80   5 1 0 0 0 0 NaN 0.001 13.5 NaN]
% sub06: [30   3 1 0.01 1.001 1.7 2 NaN 0.001 15 NaN]
% sub07: [80   35 15 1.74 4.77 10.74 34.25 NaN 0.001 13.5 NaN]
% sub08: [60   10 5 1.535 4.3425 10.62 40 NaN 0.00062 13.975 NaN]
% sub09: [25   3 1.5 0.01 0.2 2 3.2 NaN 0.001 15 NaN]
% sub10: [200  1 1 0.18 1 21.63 300.63 NaN 0.00104 5 NaN]
% sub11: [25   3 1.5 0.06 0.2 2.1 3.4 NaN 0.001 15 NaN]
% sub12: [5    2 1 0.01 1.00015 1.035 3 NaN 0.001 15 NaN]
%
%
%-------------------------------------------------------------------------
%BAYES FAT-TAIL PRIOR, MAP ('MaxLikelihoodFit'.'FatTailPrior','MAPReadout')
%-------------------------------------------------------------------------
% pathLab =  '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 2.5 1 0.6 1.2 1.74 12 NaN 0.001 30 0.5],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesFatTailPrior_Nocard',...
%     'FatTailPrior',...
%     'MAPReadout');
%
% sub02: [10  1.4 1.4 1000 2300 3050 3090 NaN 0.001 90 0.9]
% sub03: [113 7 2 7 100 400 600 NaN 0.00076 100 0.5]
% sub04: [79.3 4 0.04 0.04 0.05 5.6 12 NaN 0.00039 17 0.12]
% sub05: [79.3 2 0.64 0.04 0.04 0.04 0.04 NaN 0.00039 17 0.06]
% sub06: [79.3 4 0.64 0.04 0.7 1.5 1.5 NaN 0.00039 17 0.06]
% sub07: [79.3 8 1.2 0.04 0.7 1.5 3 NaN 0.00039 17 0.12]
% sub08: [3 1.4 1.2 0.04 0.7 1.5 3 NaN 0.00039 17 0.5]
% sub09: [80 5.6 1.2 0.04 0.7 12.5 14 NaN 0.00039 17 0.5]
% sub10: [5 0.9 0.7 0.02 0.8 1.4 1.8 NaN 0.00039 17 0.25]
% sub11: [80 3.5 1 0.02 0.8 1.7 7.2 NaN 0.00039 17 0.25]
% sub12: [4.5 1.6 1.1 0.02 0.8 1.7 7.2 NaN 0.00039 17 0.12]
%
%-------------------------------------------------------------------------
%BAYES FAT-TAIL PRIOR ('MaxLikelihoodFit'.'FatTailPrior','SamplingReadout')
%-------------------------------------------------------------------------
% pathLab =  '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% subject 01
% subject 02
% subject 03 : [100 12.62 2.98 33 3.71 12.63 33.63 NaN 0.00104 174.80 0.6]
% subject 04
% subject 05
% subject 06
% subject 07
% subject 08
% subject 09
% subject 10
% subject 11
% subject 12
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub03'},...
%     [100 12.62 2.98 33 3.71 12.63 33.63 NaN 0.00104 174.80 0.6],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit03_vonMisesPrior_BayesFatTailPriorSampling_Nocard',...
%     'FatTailPrior',...
%     'SamplingReadout');
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub03'},...
%     [100 12.62 2.98 33 3.71 12.63 33.63 NaN 0.00104 174.80 NaN NaN NaN NaN NaN NaN NaN],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','test',...
%     'SamplingReadout');

%
%BAYES FAT-TAIL PRIOR, Sampling ('MaxLikelihoodFit'.'FatTailPrior','ChangeWTail','SamplingReadout')
%-------------------------------------------------------------------------------------------------
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub03'},...
%     [7213.59 178.55 2.97 1 0.31 0.02 0.01  NaN 0.00128 14.75 923.4248591284],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit03_vonMisesPrior_BayesFatTailPriorSampling_ChWT_Nocard',...
%     'FatTailPrior','ChangeWTail',...
%     'SamplingReadout');
%
%
%BAYES FAT TAIL PRIOR AND LLH SAMPLING READOUT - Unimodal Prior experiment
%-------------------------------------------------------------------------
%
% Paths
% pathLab =  '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,output] = ...
%     SLfitBayesianModel({'sub03'},...
%     [100 12.62 2.98 0.48 3.71 12.63 33.63 NaN 0.00104 174.80 0.0131247623],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'FatTailPriorAndLLH',...
%     'SamplingReadout',...
%     'filename','datafit03_vonMisesPrior_BayesFatTailPriorAndLLH_Nocard');
%
%
%BAYES FAT TAIL PRIOR AND LLH SAMPLING READOUT ('vonMisesPrior', 'SamplingReadout','FatTailPriorAndLLH','FitEachKvmAndTails')
%----------------------------------------------------------------------------------------------------------------------------
%
% Paths
% pathLab =  '/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub12'},...
%      [12 3 1.5 0.3 1.5 5 15 NaN 0 10^12 0.1 0.2 0.2 0.05 0.05 0.05 0.01],...
%     'MaxLikelihoodFit',...
%     'experiment','vonMisesPrior',...
%     'FatTailPriorAndLLH','FitEachKvmAndTails',...
%     'SamplingReadout',...
%     'filename','datafit12_vmPrior_BayesFatTailPriorAndLLH_Nocard_FitEachKvmAndTails_150515');
%
% sub01: [200 20 5 0.8 3 10 20 NaN 0 10^12 0 0.05 0.05 0.05 0.05 0.05 0.05]
% sub02: [20 3 2 8 8 14 50 NaN 0 10^200 0 0.1 0.25 0.25 0.05 0.001 0.001]
% sub03: [100 12 10 10 30 30 30 NaN 0 10^12 0 0 0 0.4 0.01 0.01 0]
% sub04: [25 12 6 6 6 6 6 NaN 0 10^12 0 0 0 0.4 0.2 0.01 0]
% sub05: [100 3 1.6 0.2 0.2 0.2 0.2 NaN 0 10^12 0 0 0 0.015 0.01 0.01 0]
% sub06: [20 9 3 .05 1.2 3 7 NaN 0 10^12 0 0.1 0.1 0.1 0.1 0.1 0.1]
% sub07: [30 10 2.4 0.5 2 8 30 NaN 0 10^12 0 0.05 0.05 0.05 0.05 0.05 0.05]
% sub08: [10 1.5 0.7 0.7 1.5 2.5 3 NaN 0 10^12 0 0.05 0.05 0.05 0.05 0.05 0.05]
% sub09: [50 6 1.5 0.7 1.5 6 12 NaN 0 10^12 0 0.05 0.05 0.05 0.05 0.05 0.05]
% sub10: [12 1.5 1 0.3 1.5 10 16 NaN 0 10^12 0 0.05 0.1 0.1 0.1 0.05 0.05]
% sub11: [50 6 2 0.3 1.5 10 20 NaN 0 10^12 0 0.1 0.2 0.2 0.2 0.2 0.2]
% sub12: [12 3 1.5 0.3 1.5 5 15 NaN 0 10^12 0.1 0.2 0.2 0.05 0.05 0.05 0.01]
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,...
%    Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub04'},...
%      [25 6 2.5 1.5 10 10 10 NaN 0 10^12 0 0.06 0.2 0.15 0.15 0.01 0],...
%     'dataPathVM',pathLab,...
%     'MaxLikelihoodFit',...
%     'experiment','vonMisesPrior',...
%     'FatTailPriorAndLLH','FitEachKvmAndTails',...
%     'SamplingReadout',...
%     'filename','datafit04_vonMisesPrior_BayesFatTailPriorAndLLH_Nocard_FitEachKvmAndTails');
%
%-----------------------------------------------------------------------
%BAYES SAMPLING - ('MaxLikelihoodFit','vonMisesPrior','SamplingReadout')
%-----------------------------------------------------------------------
%%initial parameters were evaluated by fitting manually
%
%sub01
%-----
%
% matlabpool 10
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,output] = ...
%     SLfitBayesianModel({'sub01'},...
%     [100 20 4 1.5 5 10 34 0 0.001 75 NaN],...
%     'MaxLikelihoodFit',...
%     'dataPathVM',pathLab,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesSampling_withCard',...
%     'SamplingReadout');
%
% sub02: [10  2.5 1.5 2 5 10 34 NaN 0.001 75 NaN]
% sub03: [100 10 4 2 5 10 34 NaN 0.001 75 NaN]
% sub04: [10  4 1.7 1.7 3.5 10 34 NaN 0.001 75 NaN]
% sub05: [40  4 1.7 0 0 0 0 NaN 0.001 75 NaN]
% sub06: [15  4 2 0.5 3.5 10 34 NaN 0.001 75 NaN]
% sub07: [35  7 2 0.5 2 7 34 NaN 0.001 75 NaN]
% sub08: [4   2 1 0.5 1.5 2 2.5 NaN 0.001 75 NaN]
% sub09: [30  4 2 0.5 1 6 6 NaN 0.001 75 NaN]
% sub10: [200 3 1.6 0.01 1 21.63 300.63 NaN 0.00104 5 NaN]
% sub11: [30 4 2 0.2 1 3 10 NaN 0.001 75 NaN]
% sub12: [5 2 1.5 0.15 1 3 10 NaN 0.001 75 NaN]
%
%
%-------------------------------------------------------------------------
%BAYES MAP - von Mises prior ('vonMisesPrior','MAPReadout','CrossValR2Fit')
%-------------------------------------------------------------------------
%sub01
%-----
% matlabpool 2
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negLogl,negLoglbkp,Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesMAPNoCard_CrossValR2',...
%     'MAPReadout',...
%     'CrossValR2Fit');
%
%sub02 : [101 70 22 1 3 9.74 34 NaN 0.0007 6.9]
%sub03 : [80 40 16 1.7 4.8 11 33 NaN 0.00039 17]
%sub04 : [79.3 38.9 9.19 1.7 4.8 11 33 NaN 0.00039 17],...
%sub05 : [80 5 1 0 0 0 0 NaN 0.001 13.5],...
%sub06 : [30 3 1 0.01 1.001 1.7 2 NaN 0.001 15]
%sub07 : [80 35 15 1.74 4.77 10.74 34.25 NaN 0.001 13.5]
%sub08 : [60 10 5 1.535 4.3425 10.62 40 NaN 0.00062 13.975]
%sub09 : [25 3 1.5 0.01 0.2 2 3.2 NaN 0.001 15]
%sub11 : [25 3 1.5 0.06 0.2 2.1 3.4 NaN 0.001 15]
%sub12 : [5 2 1 0.01 1.00015 1.035 3 NaN 0.001 15]
%
%-------------------------------------------------------------------------
%BAYES SAMPLING - ('vonMisesPrior','SamplingReadout','CrossValR2Fit')
%-------------------------------------------------------------------------
%
%sub01
%-----
% matlabpool 1
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%     output]=SLfitBayesianModel({'sub01'},...
%     [100 20 4 1.5 5 10 34 NaN 0.001 75],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesSamplingNoCard_CrossValR2',...
%     'SamplingReadout',...
%     'CrossValR2Fit');
%
% sub02 : [10 2.5 1.5 2 5 10 34 NaN 0.001 75]
% sub03 : [100 10 4 2 5 10 34 NaN 0.001 75]
% sub04 : [10 4 1.7 1.7 3.5 10 34 NaN 0.001 75]
% sub05 : [40 4 1.7 0 0 0 0 NaN 0.001 75]
% sub06 : [15 4 2 0.5 3.5 10 34 NaN 0.001 75]
% sub07 : [35 7 2 0.5 2 7 34 NaN 0.001 75]
% sub08 : [4 2 1 0.5 1.5 2 2.5 NaN 0.001 75]
% sub09 : [30 4 2 0.5 1 6 6 NaN 0.001 75]
% sub10 :
% sub11 : [30 4 2 0.2 1 3 10 NaN 0.001 75]
% sub12 : [5 2 1.5 0.15 1 3 10 NaN 0.001 75]
%
%------------------------------------------------------------------
%BAYES SAMPLING -
%('vonMisesPrior','SamplingReadout','CrossValR2FitTrialData')
%------------------------------------------------------------------
%
%sub01
%-----
% matlabpool 1
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%     output] = SLfitBayesianModel({'sub01'},...
%     [100 20 4 1.5 5 10 34 NaN 0.001 75],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesSamplingNoCard_CrossValR2trial5sets',...
%     'SamplingReadout',...
%     'CrossValR2FitTrialData');
%
% sub02 : [10 2.5 1.5 2 5 10 34 NaN 0.001 75]
% sub03 : [100 10 4 2 5 10 34 NaN 0.001 75]
% sub04 : [10 4 1.7 1.7 3.5 10 34 NaN 0.001 75]
% sub05 : [40 4 1.7 0 0 0 0 NaN 0.001 75]
% sub06 : [15 4 2 0.5 3.5 10 34 NaN 0.001 75]
% sub07 : [35 7 2 0.5 2 7 34 NaN 0.001 75]
% sub08 : [4 2 1 0.5 1.5 2 2.5 NaN 0.001 75]
% sub09 : [30 4 2 0.5 1 6 6 NaN 0.001 75]
% sub11 : [30 4 2 0.2 1 3 10 NaN 0.001 75]
% sub12 : [5 2 1.5 0.15 1 3 10 NaN 0.001 75]
%
%
%-----------------------------------------------------------------------
%BAYES MAP - von Mises prior
%('vonMisesPrior','MAPReadout','CrossValR2FitTrialData')
%-----------------------------------------------------------------------
%sub01
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesMAPNoCard_CrossValR2trial2sets',...
%     'MAPReadout',...
%     'CrossValR2FitTrialData');
%
%sub02 : [101 70 22 1 3 9.74 34 NaN 0.0007 6.9]
%sub03 : [80 40 16 1.7 4.8 11 33 NaN 0.00039 17]
%sub04 : [79.3 38.9 9.19 1.7 4.8 11 33 NaN 0.00039 17]
%sub05 : [80 5 1 0 0 0 0 NaN 0.001 13.5]
%sub06 : [30 3 1 0.01 1.001 1.7 2 NaN 0.001 15]
%sub07 :  [80 35 15 1.74 4.77 10.74 34.25 NaN 0.001 13.5]
%sub08 : [60 10 5 1.535 4.3425 10.62 40 NaN 0.00062 13.975]
%sub09 : [25 3 1.5 0.01 0.2 2 3.2 NaN 0.001 15]
%sub11 : [25 3 1.5 0.06 0.2 2.1 3.4 NaN 0.001 15]
%sub12 : [5 2 1 0.01 1.00015 1.035 3 NaN 0.001 15]
%
%--------------------------------------------------------------------------
%Bimodal Prior experiment ('bimodalPrior','MAPReadout', Maximum likelihood fit)
%--------------------------------------------------------------------------
%BAYES MAP
%---------
%The experimental value of the strength of the von Mises
%that compose the experimental bimodal prior was 20 degrees (k=~10.74).
%The initial value for this fit parameter was set to the initial value used
%when fitting 20 degrees unimodal von Mises prior in the unimodal prior
%experiment. It was set for each subject.
%
%subject 01
%----------
% matlabpool 4
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,logl,negLoglbkp,Logl_pertrialBestfit]=SLfitBayesianModel({'sub01'},...
%     {'coh','priormodes','FeatureSample'},...
%     [80 40 4 9.74 9.74 9.74 9.74 NaN 0.001 15],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','bimodalPrior',...
%     'filename','datafit01_Bimodalprior_Bayes_noCard',...
%     'MAPReadout');
%
%subject 02 : [80 2 1 60 60 60 60 NaN 0.001 15]
%subject 03 : [80 40 3 30 30 30 30 NaN 0.001 15]
%
%------------------------------------------------------------------------
%BAYES SAMPLING ('bimodalPrior','SamplingReadout', Maximum likelihood fit)
%------------------------------------------------------------------------
% matlabpool 2
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,logl,negLoglbkp,Logl_pertrialBestfit]=SLfitBayesianModel({'sub01'},...
%     {'coh','priormodes','FeatureSample'},...
%     [80 20 2 9.74 9.74 9.74 9.74 NaN 0.001 75],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','bimodalPrior',...
%     'SamplingReadout',...
%     'filename','datafit01_Bimodalprior_BayesSampling_noCard')
%
%subject 02: [80 2 0.8 60 60 60 60 NaN 0.01 15]
%subject 03: [80 40 2.5 30 30 30 30 NaN 0.004 15]
%
%
%-----------------------------
%Simulate and fit fake data (test fit)
%-----------------------------
% [coh,pstd,d,priorModes,simP]=SLsimulateBayesianModel({'sub01'},...
%    [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%    'withoutCardinal',...
%    'dataPath',...
%    pathHome,...
%    'experiment','vonMisesPrior',...
%    'MAPReadout');
%
%fit fake data
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%     output] = SLfitBayesianModel({'sub01'},...%
%     [10.74 4.77 1.74 1.74 4.77 10.74 34.25 0 0.001 15],...
%     'dataPath',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesSamplingwithCard_test',...
%     'testFakedata',...
%     'SamplingReadout');
%
% [coh,pstd,d,priorModes,simP,negLogl,negSumlogL]=SLsimulateBayesianModel({'sub03'},...
%     [80 40 2.5 30 30 30 30 NaN 0.004 15],...
%     'withoutCardinal',...
%     'dataPath',...
%     '/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','bimodalPrior',...
%     'SamplingReadout');
%fit
%[data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit]=SLfitBayesianModel({'sub01'},...
%    {'coh','priormodes','FeatureSample'},...
%    [80 40 20 1.74 4.77 10.74 34.25 0 0.001 13.5],...
%    'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%    'experiment','bimodalPrior',...
%    'filename','datafit01_bimodalPrior_BayeswithCard_fake',...
%    'testFakedata',...
%    'SamplingReadout');
%
%
%-------------------------------------------
%Draw mean data with their model predictions
%-------------------------------------------
%The predictions are for the best fit parameters obtained with maximum
%likelihood fitting.
%
%
%BAYES MAP ('vonMisesPrior','MAPReadout')
%.........................................
%sub01
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%     output] = SLfitBayesianModel({'sub01'},...
%     [15.8 8.8 1.7 0.7 1.8 2.9 41.3 NaN 0.002 22.2],...
%     'dataPath',pathHome,...
%     'experiment','vonMisesPrior',...
%     'MAPReadout',...
%     'modelPredictions');
%
%sub02: [13.1 8.5 1.1 1.1 3.7 11.1 34.2 NaN 0.0007 7.3]
%sub03: [24.3 5.7 2.2 0.02 2 4.3 10.1 NaN 0.0004 42.3]
%sub04: [9.9 1.5 1.2 0.2 0.7 1.6 3.9 NaN 0.0004 21.4]
%sub05: [12.8 2.4 1.1 0.001 0.0000005 0.0000002 0.0005 NaN 0.002 19.5]
%sub06: [30.3 3 1 0.01 1 1.6 2 NaN 0.001 15]
%sub07: [16.7 6.02 1.5 0.1 1.4 11.3 41.5 NaN 0.001 16.6]
%sub08: [83.7 10.9 7 7 21 128 351 NaN 0.0004 1.7]
%sub09: [34.6 3 1.3 0.08 1.1 3.3 33.3 NaN 0.002 10.1]
%sub11: [41.7 3.3 1.3 0.02 0.4 2 17.1 NaN 0.002 17.5]
%sub12: [5 2 1 0.01 1 1.02 3 NaN 0.001 15]
%
%
%BAYES SAMPLING ('vonMisesPrior','SamplingReadout')
%...................................................
% sub01
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%     output] = SLfitBayesianModel({'sub01'},...
%     [55.4 16.3 2.8 1.06 4 8.1 25.8 NaN 0.02 200],...
%     'dataPath',pathHome,...
%     'experiment','vonMisesPrior',...
%     'SamplingReadout',...
%     'modelPredictions');
%
% sub02 : [16.3 1.9 1.03 1.8 4.9 14.3 40.3 NaN 0.02 1172.3]
% sub03 : [106.6 14.9 3 0.6 3.7 14.2 53.1 NaN 0.01 52.7]
% sub04 : [13.3 3 1.5 0.9 2.4 8.8 18.6 NaN 0.03 757]
% sub05 : [16.7 3.5 1.7 0.04 0.05 0.05 0.002 NaN 0.004 2656]
% sub06 : [313 6.6 1.9 0.000000002 2.7 9.2 10.8 NaN 0.02 14.7]
% sub07 : [31.6 10.1 2.3 0.6 1.9 9.7 24.7 NaN 0.03 871.7]
% sub08 : [13.2 2.6 1.2 0.96 2.2 3.4 5.2 NaN 0.17 26120]
% sub09 : [28.01 7.7 2 0.9 1 6.3 7.9 NaN 0.04 2184]
% sub10 :
% sub11 : [1537.7 7 2.1 0.0001 0.5 7.9 300 NaN 0.005 16.2]
% sub12 : [10.6 2.8 1.4 0.5 2 7.6 15 NaN 0.07 195.5]
%
%---------------------------------------------------
% Get confidence over best fit parameters (std para)
%---------------------------------------------------
%
%Bayes Sampling ('SamplingReadout')
%...................................
% sub01
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%   output] = SLfitBayesianModel({'sub01'},...
%     [55.4 16.3 2.8 1.06 4 8.1 25.8 NaN 0.02 200],...
%     'dataPathVM',pathHome,...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayesSamplingNoCard_stdBestfitP',...
%     'SamplingReadout',...
%     'stdBestfitP');
%
%----------------------------------------------------------------------------
%Fit combined priors data ('MaxLikelihoodFit','vonMisesprior', 'bimodalPrior')
%-----------------------------------------------------------------------------
%I use the initial parameters obtained from manually fitting the data in
%the von Mises prior experiment.
%
%MAPReadout
%----------
%sub01
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit01_vonMisesAndBimodalPriors_BayesnoCard_maxLL',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%sub02
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub02'},...
%     [101 70 22 1 3 9.74 34 NaN 0.0007 6.9],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit02_vonMisesAndBimodalPriors_BayesnoCard_maxLL',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%sub03
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub03'},...
%     [80 40 16 1.7 4.8 11 33 NaN 0.00039 17],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit03_vonMisesAndBimodalPriors_BayesnoCard_maxLL',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%Sampling readout
%----------------
%sub01
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit01_vonMisesAndBimodalPriors_BayesSamplingnoCard_maxLL',...
%     'SamplingReadout',...
%     'MaxLikelihoodFit');
%
%sub02
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub02'},...
%     [101 70 22 1 3 9.74 34 NaN 0.0007 6.9],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit02_vonMisesAndBimodalPriors_BayesSamplingnoCard_maxLL',...
%     'SamplingReadout',...
%     'MaxLikelihoodFit');
%
%sub03
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitBayesianModel({'sub03'},...
%     [80 40 16 1.7 4.8 11 33 NaN 0.00039 17],...
%     'dataPathVM',pathHome,...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit03_vonMisesAndBimodalPriors_BayesSamplingnoCard_maxLL',...
%     'SamplingReadout',...
%     'MaxLikelihoodFit');
%
