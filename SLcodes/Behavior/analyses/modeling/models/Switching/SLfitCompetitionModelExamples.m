

%SLfitCompetitionModelExamples.m
%
%
%-----
%usage
%-----
%-----------------------------------------------------------
%fit trial-data with maximum likelihood ('MaxLikelihoodFit')
%-----------------------------------------------------------
%von Mises priors ('vonMisesPrior')
%----------------------------------
% matlabpool 3
% tic1 = tic;
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,Fbp,FA,stdPa,fitPt,logl,logL_bkp,logL_pertrialBestfit] = SLfitCompetitionModel({'sub02'},...
%    {'coh','Pstd','sample_dir'},...
%    [80 2 1 1.74 4.77 60 100 0 0.001 15],...
%    'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%    'experiment','vonMisesPrior',...
%    'filename','datafit02_vonMisesPrior_CompetitionDiv_withCard',...
%    'MaxLikelihoodFit');
% TheToc = toc(tic1)
% [means,stds] = drawStat(logL_pertrialBestfit',d,coh,pstd);
%
%----------------------------
%fit Competition bimodalPrior
%----------------------------
%
% matlabpool 3
% tic1 = tic;
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,Fbp,FA,stdPa,fitPt,logl,logL_bkp,logL_pertrialBestfit] = SLfitCompetitionModel({'sub01'},...
%    {'coh','priormodes','sample_dir'},...
%    [80 40 4 15 15 15 15 0 0.001 30],...
%    'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%    'experiment','bimodalPrior',...
%    'filename','datafit01_bimodalPrior_CompetitionDiv_withCard');
% TheToc = toc(tic1)
% [means,stds] = drawStat(logL_pertrialBestfit',d,coh,pstd);
%
%
%combined priors ('vonMisesprior' and 'bimodalPrior')
%------------------------------------------------
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub01'},...
%     [80 40 20 1.74 4.77 10.74 34.25 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit01_vonMisesAndBimodalPriors_BayesnoCard_maxLL',...
%     'MAPReadout',...
%     'MaxLikelihoodFit');
%
%-----------------------------------------------------------
%fit data mean and std with least-square error for R-squared
%Cross-Validation (mean data and std, 'CrossValR2Fit')
%-----------------------------------------------------------
% matlabpool 12
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output]=SLfitCompetitionModel({'sub02'},...
%     [80 2 1 1.74 4.77 60 100 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_CompNoCard_CrossValR2_debugging',...
%     'CrossValR2Fit');
%
%-----------------------------------------------------------
%fit trial data with least-square error for R-squared
%Cross-Validation (trial data, 'CrossValR2FitTrialData')
%-----------------------------------------------------------
% matlabpool 12
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output]=SLfitCompetitionModel({'sub02'},...
%     [80 2 1 1.74 4.77 60 100 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_CompNoCard_CrossValR2trials_debugging',...
%     'CrossValR2FitTrialData');
%
%-----------------------------------------------------------
%fit trial data with max likelihood for LogL
%Cross-Validation (trial data, 'CrossValR2FitTrialDataMaxLL')
%-----------------------------------------------------------
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output]=SLfitCompetitionModel({'sub02'},...
%     [80 2 1 1.74 4.77 60 100 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_CompNoCard_CrossValR2trials_debugging',...
%     'CrossValR2FitTrialDataMaxLL');
%
%--------------------------------------------------------------------
%Draw data mean, std and distribution with their model predictions
%for individual subjects or averaged over subjects
%--------------------------------------------------------------------
%The function retrieves the best fit parameters available for each subject
%in the folder 'modelfit/AIC' to make the predictions.
%
%     SLfitCompetitionModel({'sub01','sub02','sub03','sub04','sub05',
%     'sub06','sub07','sub08','sub09','sub11','sub12'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','vonMisesPrior',...
%     'modelPredictions','withData',...
%     'directoryFitParameter','../modelfit/AIC/',...
%     'filename','savedModelPreds');
%
%    SLfitCompetitionModel({'sub02'},...
%     [NaN NaN NaN NaN NaN NaN NaN NaN NaN NaN],...
%     'experiment','vonMisesPrior',...
%     'modelPredictions','withData',...
%     'directoryFitParameter','../modelfit/AIC/',...
%     'filename','savedModelPred02');

%-------------------------------------------------------------------------
%(Free predictions) Draw model's predicted data mean, std and distribution
%given input parameters
%------------------------------------------------------------------------
%
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub10'},...
%     [200 1 1 0.18 1 21.63 300.63 NaN 0.00104 5],...
%     'experiment','vonMisesPrior',...
%     'modelPredictions','withData');
%
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub02'},...
%     [14.66 1.867 0.76 1.4 5.86 37 82 NaN 0.001 92.2],...
%     'experiment','vonMisesPrior',...
%     'modelPredictions','noData');
%
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,...
%     fitPt,negElogL,logL_bkp,...
%     logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub01'},...
%     [80 40 4 15 15 15 15 NaN 0.001 30],...
%     'experiment','bimodalPrior',...
%     'modelPredictions');
%
%superimpose prior conditions
%----------------------------
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,...
%     fitPt,negElogL,logL_bkp,...
%     logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub01'},...
%     [26 5 1.85 0.7 2.7 8.7 33 NaN 0 3000],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions',...
%     'SuperImposedPrior');
%
%--------------------------------------------------------------------
%Get standard error of best fit parameters ('stdBestfitP')
%--------------------------------------------------------------------
%Fit data with fminsearch first (with 'MaxLikelihoodFit' usage), then
%run this
%
%
%sub02
%-----
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub02'},...
%     [16.1 1.7 1.1 1.2 2.4 15.6 653 NaN 0.01 24.3],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%------------------
%MAX LIKELIHOOD FIT
%------------------
%
%%von Mises Prior
%----------------
%divisive competition (MaxLikelihoodFit')
%----------------------------------------
%
%set cardinal strength to NaN if you don't want to fit cardinal prior.
%
% pathLab ='/Users/steeve/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
% pathHome = '/Users/steeve_laquitaine/Dropbox/Project_withJustin/data/dataPsychophy/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/';
%
%
%subject 01
%----------
% matlabpool 3
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub01'},...`
%    [80 30 2 0.7 3 7 33 0 0.001 30],...
%    'MaxLikelihoodFit',...
%    'dataPathVM',pathLab,...
%    'experiment','vonMisesPrior',...
%    'filename','datafit01_vonMisesPrior_CompetitionDiv_withCard');
%
% subject 02: [80 2 1 1.74 4.77 60 100 NaN 0.001 15]
% subject 03: [80 40 3 1.74 4.77 30 40 NaN 0.001 15]
% subject 04: [80 3 0.5 0.3 0.9 3 21 NaN 0.001 15]
% subject 05: [80 2 0.5 0 0 0 0 NaN 0.001 15]
% subject 06: [80 4 1 0 3 21 25 NaN 0.001 15]
% subject 07: [80 6 2 0.3 3 10.74 21 NaN 0.001 18]
% subject 08: [80 1 0.4 0.1 2 2 5 NaN 0.001 3]
% subject 09: [80 16 2 0.1 0.7 10 10 NaN 0.001 18]
% subject 10: [200 1 1 0.18 1 21.63 300.63 NaN 0.00104 5]
% subject 11: [80 3 1 0.00005 0.2 3 15 NaN 0.001 30]
% subject 12: [5 2.5 1 0.3 1.7 6 33 NaN 0.001 17]
%
%
%
%------------------------
%Bimodal Prior experiment
%------------------------
%The experimental value of the strength of the von Mises
%that compose the experimental bimodal prior was 20 degrees (k=~10.74).
%The initial value for this fit parameter was set to the best fit value
%obtained when fitting 20 degrees unimodal von Mises prior manually in the
%unimodal prior experiment with Competition model. It was set for each
%subject.
%We used the same likelihood strengths as in the unimodal prior experiment.
%

%divisive competition
%--------------------
%subject 01
%----------
% matlabpool 3
% tic
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,Fbp,FA,stdPa,fitPt,logl,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub01'},...
%    [80 40 4 15 15 15 15 0 0.001 30],...
%    'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%    'experiment','bimodalPrior',...
%    'filename','datafit01_bimodalPrior_CompetitionDiv_withCard');
% TheToc=toc
% [means,stds]=drawStat(logL_pertrialBestfit',d,coh,pstd);
%
%subject 02: [80 2 1 60 60 60 60 0 0.001 15]
%subject 03: [80 40 3 30 30 30 30 0 0.001 15]
%
%
%----------------------------------------------------
%Divisive competition - Cross-validated R^2
%----------------------------------------------------
%Initial parameters are the same as the initial parameters used for maximum
%likelihood fitting. They were found by manual fitting with graphical
%evaluation of the match between data and predictions.
%
%sub01
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub01'},...
%     [80 30 2 0.7 3 7 33 NaN 0.001 30],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_CompNoCard_CrossValR2',...
%     'CrossValR2Fit');
%
%sub02: [80 2 1 1.74 4.77 60 100 NaN 0.001 15]
%sub03: [80 40 3 1.74 4.77 30 40 0 0.001 15]
%sub04 : [80 3 0.5 0.3 0.9 3 21 NaN 0.001 15]
%sub05 : [80 2 0.5 0 0 0 0 NaN 0.001 15]
%sub06 : [80 4 1 0 3 21 25 NaN 0.001 15]
%sub07 : [80 6 2 0.3 3 10.74 21 NaN 0.001 18]
%sub08 : [80 1 0.4 0.1 2 2 5 NaN 0.001 3]
%sub09 : [80 16 2 0.1 0.7 10 10 NaN 0.001 18]
%sub11 : [80 3 1 0.00005 0.2 3 15 NaN 0.001 30]
%sub12 : [5 2.5 1 0.3 1.7 6 33 NaN 0.001 17]
%
%-------------------------------------------------------
%Divisive competition - Cross-validated R^2 (trial-data)
%-------------------------------------------------------
%Initial parameters are the same as the initial parameters used for maximum
%likelihood fitting. They were found by manual fitting with graphical
%evaluation of the match between data and predictions.
%
%sub01
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output]=SLfitCompetitionModel({'sub01'},...

%     [80 30 2 0.7 3 7 33 NaN 0.001 30],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_CompNoCard_CrossValR2trials5sets',...
%     'CrossValR2FitTrialData');
%
%sub02: [80 2 1 1.74 4.77 60 100 NaN 0.001 15]
%sub03: [80 40 3 1.74 4.77 30 40 0 0.001 15]
%sub04: [80 3 0.5 0.3 0.9 3 21 NaN 0.001 15]
%sub05: [80 2 0.5 0 0 0 0 NaN 0.001 15]
%sub06: [80 4 1 0 3 21 25 NaN 0.001 15]
%sub07: [80 6 2 0.3 3 10.74 21 NaN 0.001 18]
%sub08: [80 1 0.4 0.1 2 2 5 NaN 0.001 3]
%sub09: [80 16 2 0.1 0.7 10 10 NaN 0.001 18]
%sub11: [80 3 1 0.00005 0.2 3 15 NaN 0.001 30]
%sub12: [5 2.5 1 0.3 1.7 6 33 NaN 0.001 17]
%
%----------------------------------------------
%%Test fake data for von Mises Prior experiment
%----------------------------------------------
%
%unimodal
%-------
%to fit cardinal unNaN cardinal parameter
%%simulate fake data (tested and works)
%
% tic
% [pred,coh,pstd,d,priorModes,simP]=SLsimulateCompetitionModel({'sub12'},...
%     [5 2.5 1 0.3 1.7 6 33 0 0.001 17],...
%     'withoutCardinal',...
%     'dataPath',...
%     '/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior');
% toc
%
%%fit fake data (tested and works)
% matlabpool 10
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub01'},...

%     [80 30 2 0.7 3 7 33 0 0.001 30],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_BayeswithCard',...
%     'testFakedata');
% [means,stds]=drawStat(logL_pertrialBestfit',d,coh,pstd);
%
%
%bimodal
%-------
% [pred,coh,pstd,d,priorModes,simP,negElogL,negSumlogL] = SLsimulateCompetitionModel({'sub01'},...
%     [80 40 20 20 20 20 20 0 0.001 13],...
%     'dataPath',...
%     '/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','bimodalPrior');
%
%%fit fake data (tested and works)
% matlabpool 10
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit] = SLfitCompetitionModel({'sub01'},...
%     {'coh','priormodes','sample_dir'},...
%     [80 40 20 20 20 20 20 0 0.001 13],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','bimodalPrior',...
%     'filename','datafit01_bimodalPrior_CompCardFake',...
%     'testFakedata');
% [means,stds] = drawStat(logL_pertrialBestfit',d,coh,pstd);
%
%
%-------------------------------------------
%Draw mean data with their model predictions
%-------------------------------------------
%sub01
%-----
%[data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub01'},...

%     [370 13.8 2.4 0.4 1.2 5.1 33 NaN 0.002 28.7],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions');
%
%sub02: [16.1 1.7 1.1 1.2 2.4 15.6 653 NaN 0.01 24.3]
%sub03: [374 13.7 2.5 0.7 2.2 8.4 98.8 NaN 0.008 30.5]
%sub04: [16 2.3 1.3 0.5 1.2 11.9 342 NaN 0.002 13.4]
%sub05: [10.8 2.3 1.1 0.0006 0.0003 0.005 0 NaN 0.002 28]
%sub06: [6155 2.9 1.1 0.02 0.79 4 11.5 NaN 0.005 9.7]
%sub07: [183.5 9.1 1.9 0.4 0.9 14 53.8 NaN 0.02 19.2]
%
%sub08
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub08'},...

%     [2144.4 3.2 1.2 0.6 1.6 3.2 7.7 NaN 0.19 6.4],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions');
%
%sub09
%-----
%[data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub09'},...

%     [66.6 6.4 1.6 0.6 0.4 6.3 12.7 NaN 0.01 12],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions');
%
%sub11
%-----
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub11'},...

%     [133.3 3.7 1.3 0.001 0.4 3.8 24.2 NaN 0.004 17.4],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions');
%
%sub12
%-----
% [data,d,coh,pstd,Sp,pred,fitP,fitPbkp,R2,sdata,FAbp,FA,stdPa,fitPt,negElogL,logL_bkp,logL_pertrialBestfit]=SLfitCompetitionModel({'sub12'},...

%     [7.3 1.8 0.9 0.2 1 3.7 224.6 NaN 0.003 12.7],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'modelPredictions');
%
%
%------------------------------------------------------
% Get std of best fit parameters , best model (fmincon)
%------------------------------------------------------
%
%sub02
%-----
% matlabpool 10
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub02'},...

%     [16.1 1.7 1.1 1.2 2.4 15.6 653 NaN 0.01 24.3],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub03
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub03'},...

%     [374 13.7 2.5 0.7 2.2 8.4 98.8 NaN 0.008 30.5],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit03_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub04
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub04'},...

%     [16 2.3 1.3 0.5 1.2 11.9 342 NaN 0.002 13.4],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit04_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub05
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub05'},...

%     [10.8 2.3 1.1 0.0006 0.0003 0.005 0 NaN 0.002 28],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit05_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub06
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub06'},...

%     [6155 2.9 1.1 0.02 0.79 4 11.5 NaN 0.005 9.7],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit06_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub07
%-----
% matlabpool 5
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub07'},...

%     [183.5 9.1 1.9 0.4 0.9 14 53.8 NaN 0.02 19.2],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit07_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub08
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub08'},...

%     [2144.4 3.2 1.2 0.6 1.6 3.2 7.7 NaN 0.19 6.4],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit08_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub09
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub09'},...

%     [66.6 6.4 1.6 0.6 0.4 6.3 12.7 NaN 0.01 12],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit09_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub11
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub11'},...

%     [133.3 3.7 1.3 0.001 0.4 3.8 24.2 NaN 0.004 17.4],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit11_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%sub12
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub12'},...

%     [7.3 1.8 0.9 0.2 1 3.7 224.6 NaN 0.003 12.7],...
%     'dataPath','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit12_vonMisesPrior_DivCompNoCard_stdBestfitP',...
%     'stdBestfitP');
%
%--------------------------------------------------------
%fit Combined priors ('vonMisesprior' and 'bimodalPrior')
%--------------------------------------------------------
%I use the initial parameters obtained from manually fitting the data in
%the von Mises prior experiment.
%
%sub01
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub01'},...
%     [80 30 2 0.7 3 7 33 NaN 0.001 30],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit01_vonMisesAndBimodalPriors_DivCompnoCard_maxLL',...
%     'MaxLikelihoodFit');
%
%sub02
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub02'},...
%     [80 2 1 1.74 4.77 60 100 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit02_vonMisesAndBimodalPriors_DivCompnoCard_maxLL',...
%     'MaxLikelihoodFit');
%
%sub03
%-----
% matlabpool 12
% [fitP,fitPbkp,R2,sdata,fitPt,negLogl,negLoglbkp,Logl_pertrialBestfit,...
%      output] = SLfitCompetitionModel({'sub03'},...
%     [80 40 3 1.74 4.77 30 40 0 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'dataPathBim','/Users/steeve/Steeve_psychophy_data/Exp02_Bimodal_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2',...
%     'experiment','vonMisesPrior','bimodalPrior',...
%     'filename','datafit03_vonMisesAndBimodalPriors_DivCompnoCard_maxLL',...
%     'MaxLikelihoodFit');
%
%-----------------------------------------------------
%Cross-validation with max log likelihood (trial-data)
%-----------------------------------------------------
%
%Initial parameters are the same as the initial parameters used for maximum
%likelihood fitting. They were found by manual fitting with graphical
%evaluation of the match between data and predictions for von Mises prior.
%
%sub01
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] = SLfitCompetitionModel({'sub01'},...
%     [80 30 2 0.7 3 7 33 NaN 0.001 30],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit01_vonMisesPrior_CompNoCard_CrossValmaxlogl',...
%     'CrossValR2FitTrialDataMaxLL');
%
%sub02
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output]=SLfitCompetitionModel({'sub02'},...
%     [80 2 1 1.74 4.77 60 100 NaN 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit02_vonMisesPrior_CompNoCard_CrossValmaxlogl',...
%     'CrossValR2FitTrialDataMaxLL');
%
%sub03
%-----
% matlabpool 1
% [data,d,coh,pstd,Sp,fitP,fitPbkp,R2,sdata,FAbp,FA,fitPt,...
%     negElogL,logL_bkp,logL_pertrialBestfit,output] =SLfitCompetitionModel({'sub03'},...
%     [80 40 3 1.74 4.77 30 40 0 0.001 15],...
%     'dataPathVM','/Users/steeve/Steeve_psychophy_data/Exp01_Variance_Pstd010020040080_coh006012024_dirfull_Pmean225_fix10_mot035_fB01_speed28_PwMate_reBalanced_stat4_v2/MostUpdated/Code_004mainfinalCardinalsOutRndInitPosSymPrior',...
%     'experiment','vonMisesPrior',...
%     'filename','datafit03_vonMisesPrior_CompNoCard_CrossValmaxlogl',...
%     'CrossValR2FitTrialDataMaxLL');
