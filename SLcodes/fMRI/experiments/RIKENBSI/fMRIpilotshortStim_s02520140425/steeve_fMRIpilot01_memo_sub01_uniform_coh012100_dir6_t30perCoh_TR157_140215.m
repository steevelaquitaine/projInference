
% memo.m
%
%                  $Id: memo experiment.m 380 2013-12-24 07:00:55Z steeve $
%                   by: Steeve Laquitaine
%                 date: 14/02/14
%              Purpose: fMRI task with short motion (.3s) and long ISI of
%              11.7s. Can we still decode motion direction.
%  `            Subject: Steeve

%               Usage: this code requires 2 files to work properly:
                        % - task.mat files (parameters) contained in a method file: e.g.,
                        % "120925_steeve_exp03_metho_param_dir6_var0030_mean195_coh012_024_062_1_t125_eye.mat"
                        % this file is generated by the function 'initPriors'
                        % - taskDotDir.m (function that run the experiment)
                   
%Procedure
%# the parameters for each sub-block are pre-set with 'initPriors' for
%stored in the directory in a 'metho'.mat file.    

%if problem to get the proper parameters in psychophysics room use
%mglSetParam('screenParamsFilename','/Users/yuko/.mglScreenParams.mat',1);

%%To use on "Cycle" computer uncomment this line:                        
%mglSetParam('screenParamsFilename','/Users/steeve/proj/mgl/task/displays/.mglScreenParams.mat',1)                        
     
% Those are my fMRI experiment's details:
% 
% The details for the entire experiment are:
% - T-sense
% - TR=1.57s (1.5s<TR<1.57s)
% - First, we show the localizer then the main task then the localizer again
% - 9 scans
% - total number of volumes: 2480
% - total duration: at least 1hour 5min (without breaks)
% - cover early visual areas and Parietal cortex
% 
% more details
% Localizer (1 scan)
% - number of volumes:176 (88 vols when acceleration x2)
% - duration: 4min 36s
% - then <1min break
% 
% Main task (7 scans)
% - number of volumes:304 (152 vols when acceleration x2)
% - duration: 7min 57s
% - <1min break between scan
% 
% Localizer (1 scan)
% - number of volumes:176
% - duration: 4min 36s


% localizer (TR=1.57;acquire 1 thrown out + 10 trial`s (176 vols))
%TR may change slightly between 1.5 & >1.5. If the number of volumes is 
%not proper relative to trial duration, 1.5s TR will be too short 
%to aquire all the trials.
%If I want to collect 8 vols/trials and TR change such that 1.5s<=TR<=1.71s
%a trial should last 12s (because 12/8 vols <= TR <= 12/7 vols)

%note: sometimes matlab crashes. It is due to mglSimulateRun

%% localizer (1.5<TR<1.57;acquire 1 thrown out + 10 trials (176 vols))
%1 scan
%mglSimulateRun(1.57,176,3); 
dotslocSL('randMotion')


%% main task (1.5<TR=1.57;acquire 2 thrown out + 36 trials (304 vols))
%7 scans
mglSimulateRun(1.57,304)
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')
TaskdotDirfMRI('steeve_fMRIpilot01_metho_uniform_coh012100_dir6_t18perCoh_TR157_140215')


%% localizer
%1 scan
%mglSimulateRun(1.57,176,5); 
dotslocSL('black')






